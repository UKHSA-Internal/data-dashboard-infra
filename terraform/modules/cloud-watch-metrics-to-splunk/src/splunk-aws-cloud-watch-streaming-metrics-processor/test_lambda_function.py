import unittest
import os
from SplunkAWSCloudWatchStreamingMetricsProcessor import lambda_function


class Test(unittest.TestCase):
	def test_lambda_handler_json_format(self):
		os.environ['METRICS_OUTPUT_FORMAT'] = "json"
		os.environ['SPLUNK_CLOUDWATCH_SOURCETYPE'] = "aws:cloudwatch"
		self.event = {
			"invocationId": "214e762e-a57f-48c7-9251-337e60f10dfd",
			"deliveryStreamArn": "arn:aws:firehose:us-east-1:134183635603:deliverystream/firehose-to-splunk",
			"region": "us-west-2",
			"records": [
				{'recordId': '49612287777320422440958116197821542933675355349578678274000000',
				 'approximateArrivalTimestamp': 1617727918160,
				 'data': 'eyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiU3RhdHVzQ2hlY2tGYWlsZWQiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTBlNDM2ZjY4NDhkMzdkZDQyIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX0luc3RhbmNlIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wNTk5MTJjMTk0MzI5OThkOCJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJTdGF0dXNDaGVja0ZhaWxlZCIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktMDhlZDI5ZTQ3NTEwYjNhNmUifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMCwibWF4IjowLjAsIm1pbiI6MC4wfSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiQ1BVU3VycGx1c0NyZWRpdEJhbGFuY2UiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTA0YTg1MjEzMzJjNzhmZjRlIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wNGE4NTIxMzMyYzc4ZmY0ZSJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJTdGF0dXNDaGVja0ZhaWxlZF9TeXN0ZW0iLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLWRiMjgzOGQzIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX1N5c3RlbSIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktMDhmM2U0YzllNzczOWQ5MWUifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMCwibWF4IjowLjAsIm1pbiI6MC4wfSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiU3RhdHVzQ2hlY2tGYWlsZWRfSW5zdGFuY2UiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTBlNDM2ZjY4NDhkMzdkZDQyIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX1N5c3RlbSIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktMGRlMDc3YWFiZTc2NjI4ODAifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMCwibWF4IjowLjAsIm1pbiI6MC4wfSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiU3RhdHVzQ2hlY2tGYWlsZWRfSW5zdGFuY2UiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTAzOTdiZDliNGNhZGIxY2NlIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wOGYzZTRjOWU3NzM5ZDkxZSJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJTdGF0dXNDaGVja0ZhaWxlZF9TeXN0ZW0iLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTA0YTg1MjEzMzJjNzhmZjRlIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wMDEzZThmM2EyNjA1ODlmMSJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJDUFVTdXJwbHVzQ3JlZGl0c0NoYXJnZWQiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTA0YTg1MjEzMzJjNzhmZjRlIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IkNQVUNyZWRpdEJhbGFuY2UiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTA0YTg1MjEzMzJjNzhmZjRlIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjoyODguMCwibWF4IjoyODguMCwibWluIjoyODguMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX1N5c3RlbSIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktMGU0MzZmNjg0OGQzN2RkNDIifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMCwibWF4IjowLjAsIm1pbiI6MC4wfSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiU3RhdHVzQ2hlY2tGYWlsZWRfU3lzdGVtIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wNTk5MTJjMTk0MzI5OThkOCJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJTdGF0dXNDaGVja0ZhaWxlZF9JbnN0YW5jZSIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktMDdiYmYwM2VhODhhNDU5YWIifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMCwibWF4IjowLjAsIm1pbiI6MC4wfSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiU3RhdHVzQ2hlY2tGYWlsZWRfSW5zdGFuY2UiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTAxNmFkOTA2MjZiMjc2OTc2In0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX0luc3RhbmNlIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wOGVkMjllNDc1MTBiM2E2ZSJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJTdGF0dXNDaGVja0ZhaWxlZF9JbnN0YW5jZSIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktMDc5Njk1ZTJkYjhmNzRkMTAifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMCwibWF4IjowLjAsIm1pbiI6MC4wfSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiU3RhdHVzQ2hlY2tGYWlsZWRfSW5zdGFuY2UiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTA0YTg1MjEzMzJjNzhmZjRlIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX1N5c3RlbSIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktYWI1NGEyNmMifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMCwibWF4IjowLjAsIm1pbiI6MC4wfSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiTWV0YWRhdGFOb1Rva2VuIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wZTQzNmY2ODQ4ZDM3ZGQ0MiJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJDUFVDcmVkaXRVc2FnZSIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktMDRhODUyMTMzMmM3OGZmNGUifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMDE5OTkxMDMzMzMzMzMzMzM1LCJtYXgiOjAuMDE5OTkxMDMzMzMzMzMzMzM1LCJtaW4iOjAuMDE5OTkxMDMzMzMzMzMzMzM1fSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiTWV0YWRhdGFOb1Rva2VuIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wYTE1ZWI5ZTIxZDYyOThmMSJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJNZXRhZGF0YU5vVG9rZW4iLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLWFiNTRhMjZjIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjozMi4wLCJtYXgiOjMyLjAsIm1pbiI6MzIuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX0luc3RhbmNlIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wMDg1MzBkZDMxMDdmNDQ0YiJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJTdGF0dXNDaGVja0ZhaWxlZF9TeXN0ZW0iLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTAzOTdiZDliNGNhZGIxY2NlIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX1N5c3RlbSIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktMDc5Njk1ZTJkYjhmNzRkMTAifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMCwibWF4IjowLjAsIm1pbiI6MC4wfSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiU3RhdHVzQ2hlY2tGYWlsZWQiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTAzOTdiZDliNGNhZGIxY2NlIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX1N5c3RlbSIsImRpbWVuc2lvbnMiOnsiSW5zdGFuY2VJZCI6ImktMDdiYmYwM2VhODhhNDU5YWIifSwidGltZXN0YW1wIjoxNjE3NzI3NzQwMDAwLCJ2YWx1ZSI6eyJjb3VudCI6MS4wLCJzdW0iOjAuMCwibWF4IjowLjAsIm1pbiI6MC4wfSwidW5pdCI6IkNvdW50In0KeyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0LWN3LW1ldHJpYy1zdHJlYW0iLCJhY2NvdW50X2lkIjoiMTEyNTQzODE3NjI0IiwicmVnaW9uIjoidXMtd2VzdC0yIiwibmFtZXNwYWNlIjoiQVdTL0VDMiIsIm1ldHJpY19uYW1lIjoiU3RhdHVzQ2hlY2tGYWlsZWRfSW5zdGFuY2UiLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTAwMTNlOGYzYTI2MDU4OWYxIn0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9CnsibWV0cmljX3N0cmVhbV9uYW1lIjoidGVzdC1jdy1tZXRyaWMtc3RyZWFtIiwiYWNjb3VudF9pZCI6IjExMjU0MzgxNzYyNCIsInJlZ2lvbiI6InVzLXdlc3QtMiIsIm5hbWVzcGFjZSI6IkFXUy9FQzIiLCJtZXRyaWNfbmFtZSI6IlN0YXR1c0NoZWNrRmFpbGVkX0luc3RhbmNlIiwiZGltZW5zaW9ucyI6eyJJbnN0YW5jZUlkIjoiaS0wYTE1ZWI5ZTIxZDYyOThmMSJ9LCJ0aW1lc3RhbXAiOjE2MTc3Mjc3NDAwMDAsInZhbHVlIjp7ImNvdW50IjoxLjAsInN1bSI6MC4wLCJtYXgiOjAuMCwibWluIjowLjB9LCJ1bml0IjoiQ291bnQifQp7Im1ldHJpY19zdHJlYW1fbmFtZSI6InRlc3QtY3ctbWV0cmljLXN0cmVhbSIsImFjY291bnRfaWQiOiIxMTI1NDM4MTc2MjQiLCJyZWdpb24iOiJ1cy13ZXN0LTIiLCJuYW1lc3BhY2UiOiJBV1MvRUMyIiwibWV0cmljX25hbWUiOiJTdGF0dXNDaGVja0ZhaWxlZF9TeXN0ZW0iLCJkaW1lbnNpb25zIjp7Ikluc3RhbmNlSWQiOiJpLTNhNGE2YjM1In0sInRpbWVzdGFtcCI6MTYxNzcyNzc0MDAwMCwidmFsdWUiOnsiY291bnQiOjEuMCwic3VtIjowLjAsIm1heCI6MC4wLCJtaW4iOjAuMH0sInVuaXQiOiJDb3VudCJ9Cg=='},

			]
		}

		ret = lambda_function.lambda_handler(self.event, "")
		assert ret['records'][0]['result'] == "Ok"

	def test_lambda_handler_otel_format(self):
		os.environ['METRICS_OUTPUT_FORMAT'] = "otel"
		os.environ['SPLUNK_CLOUDWATCH_SOURCETYPE'] = "aws:cloudwatch:metric"
		self.event = {
			"invocationId": "214e762e-a57f-48c7-9251-337e60f10dfd",
			"deliveryStreamArn": "arn:aws:firehose:us-east-1:134183635603:deliverystream/firehose-to-splunk",
			"region": "us-west-2",
			"records": [
				# OTELv0.7 formatted record
				{'recordId': '49612287777320422440958116188536992639034880348691365890000000', 'approximateArrivalTimestamp': 1617726129769, 'data': '+z4K+D4KvwEKFwoOY2xvdWQucHJvdmlkZXISBQoDYXdzCiIKEGNsb3VkLmFjY291bnQuaWQSDgoMMTEyNTQzODE3NjI0ChsKDGNsb3VkLnJlZ2lvbhILCgl1cy13ZXN0LTIKYwoQYXdzLmV4cG9ydGVyLmFybhJPCk1hcm46YXdzOmNsb3Vkd2F0Y2g6dXMtd2VzdC0yOjExMjU0MzgxNzYyNDptZXRyaWMtc3RyZWFtL3Rlc3QtY3ctbWV0cmljLXN0cmVhbRKzPRLIAQojYW1hem9uYXdzLmNvbS9BV1MvRUMyL0VCU1dyaXRlQnl0ZXMaAkJ5WpwBCpkBChQKCU5hbWVzcGFjZRIHQVdTL0VDMgobCgpNZXRyaWNOYW1lEg1FQlNXcml0ZUJ5dGVzCiEKCkluc3RhbmNlSWQSE2ktMDc5Njk1ZTJkYjhmNzRkMTARAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAAMCcZUEyCREAAAAAgMRTQTISCQAAAAAAAPA/EQAAAAAAdVdBEqsBCiVhbWF6b25hd3MuY29tL0FXUy9FQzIvTWV0YWRhdGFOb1Rva2VuGgd7Q291bnR9WnkKdwoUCglOYW1lc3BhY2USB0FXUy9FQzIKHQoKTWV0cmljTmFtZRIPTWV0YWRhdGFOb1Rva2VuChgKCkluc3RhbmNlSWQSCmktM2E0YTZiMzURAODp1TlRcxYZADgxzkdRcxYhAQAAAAAAAAAyADIJCQAAAAAAAPA/EsgBCiNhbWF6b25hd3MuY29tL0FXUy9FQzIvRUJTV3JpdGVCeXRlcxoCQnlanAEKmQEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyChsKCk1ldHJpY05hbWUSDUVCU1dyaXRlQnl0ZXMKIQoKSW5zdGFuY2VJZBITaS0wNjYwOWU4OTdkN2Q0Y2IxZREA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAQAF9QTIJEQAAAACAoGlBMhIJAAAAAAAA8D8RAAAAAAAxcEESqQEKImFtYXpvbmF3cy5jb20vQVdTL0VDMi9FQlNSZWFkQnl0ZXMaAkJ5Wn8KfQoUCglOYW1lc3BhY2USB0FXUy9FQzIKGgoKTWV0cmljTmFtZRIMRUJTUmVhZEJ5dGVzCiEKCkluc3RhbmNlSWQSE2ktMDhmM2U0YzllNzczOWQ5MWURAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAAyADIJCQAAAAAAAPA/EskBCiFhbWF6b25hd3MuY29tL0FXUy9FQzIvRUJTV3JpdGVPcHMaB3tDb3VudH1amgEKlwEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyChkKCk1ldHJpY05hbWUSC0VCU1dyaXRlT3BzCiEKCkluc3RhbmNlSWQSE2ktMDY2MDllODk3ZDdkNGNiMWURAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAAAAIoEAyCREAAAAAAOCPQDISCQAAAAAAAPA/EQAAAAAAIJBAEssBCiVhbWF6b25hd3MuY29tL0FXUy9FQzIvRUJTQnl0ZUJhbGFuY2UlGgElWp4BCpsBChQKCU5hbWVzcGFjZRIHQVdTL0VDMgodCgpNZXRyaWNOYW1lEg9FQlNCeXRlQmFsYW5jZSUKIQoKSW5zdGFuY2VJZBITaS0wNjYwOWU4OTdkN2Q0Y2IxZREA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAAMBoQDIJEQAAAAAAwFhAMhIJAAAAAAAA8D8RAAAAAADAWEAS0wEKJmFtYXpvbmF3cy5jb20vQVdTL0VDMi9OZXR3b3JrUGFja2V0c0luGgd7Q291bnR9Wp8BCpwBChQKCU5hbWVzcGFjZRIHQVdTL0VDMgoeCgpNZXRyaWNOYW1lEhBOZXR3b3JrUGFja2V0c0luCiEKCkluc3RhbmNlSWQSE2ktMDE2YWQ5MDYyNmIyNzY5NzYRAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAAACAVUAyCREAAAAAAABAQDISCQAAAAAAAPA/EQAAAAAAAEtAEscBCiNhbWF6b25hd3MuY29tL0FXUy9FQzIvRUJTSU9CYWxhbmNlJRoBJVqcAQqZAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKGwoKTWV0cmljTmFtZRINRUJTSU9CYWxhbmNlJQohCgpJbnN0YW5jZUlkEhNpLTAwODUzMGRkMzEwN2Y0NDRiEQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAKQAAAAAAwGhAMgkRAAAAAADAWEAyEgkAAAAAAADwPxEAAAAAAMBYQBLTAQomYW1hem9uYXdzLmNvbS9BV1MvRUMyL05ldHdvcmtQYWNrZXRzSW4aB3tDb3VudH1anwEKnAEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyCh4KCk1ldHJpY05hbWUSEE5ldHdvcmtQYWNrZXRzSW4KIQoKSW5zdGFuY2VJZBITaS0wNjYwOWU4OTdkN2Q0Y2IxZREA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAAGBwQDIJEQAAAAAAgF1AMhIJAAAAAAAA8D8RAAAAAAAAYkASxwEKI2FtYXpvbmF3cy5jb20vQVdTL0VDMi9FQlNJT0JhbGFuY2UlGgElWpwBCpkBChQKCU5hbWVzcGFjZRIHQVdTL0VDMgobCgpNZXRyaWNOYW1lEg1FQlNJT0JhbGFuY2UlCiEKCkluc3RhbmNlSWQSE2ktMDRhODUyMTMzMmM3OGZmNGURAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAAADAaEAyCREAAAAAAMBYQDISCQAAAAAAAPA/EQAAAAAAwFhAEq0BCiRhbWF6b25hd3MuY29tL0FXUy9FQzIvQ1BVVXRpbGl6YXRpb24aASVagQEKfwoUCglOYW1lc3BhY2USB0FXUy9FQzIKHAoKTWV0cmljTmFtZRIOQ1BVVXRpbGl6YXRpb24KIQoKSW5zdGFuY2VJZBITaS0wMDg1MzBkZDMxMDdmNDQ0YhEA4OnVOVFzFhkAODHOR1FzFiEBAAAAAAAAADIAMgkJAAAAAAAA8D8SsAEKJWFtYXpvbmF3cy5jb20vQVdTL0VDMi9NZXRhZGF0YU5vVG9rZW4aATFagwEKgAEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyCh0KCk1ldHJpY05hbWUSD01ldGFkYXRhTm9Ub2tlbgohCgpJbnN0YW5jZUlkEhNpLTAxNmFkOTA2MjZiMjc2OTc2EQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAMgAyCQkAAAAAAADwPxLVAQonYW1hem9uYXdzLmNvbS9BV1MvRUMyL05ldHdvcmtQYWNrZXRzT3V0Ggd7Q291bnR9WqABCp0BChQKCU5hbWVzcGFjZRIHQVdTL0VDMgofCgpNZXRyaWNOYW1lEhFOZXR3b3JrUGFja2V0c091dAohCgpJbnN0YW5jZUlkEhNpLTAwODUzMGRkMzEwN2Y0NDRiEQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAKQAAAAAAABxAMgkRAAAAAAAA8D8yEgkAAAAAAADwPxEAAAAAAAAYQBLCAQogYW1hem9uYXdzLmNvbS9BV1MvRUMyL05ldHdvcmtPdXQaAkJ5WpkBCpYBChQKCU5hbWVzcGFjZRIHQVdTL0VDMgoYCgpNZXRyaWNOYW1lEgpOZXR3b3JrT3V0CiEKCkluc3RhbmNlSWQSE2ktMDRhODUyMTMzMmM3OGZmNGURAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAAABQyEAyCREAAAAAAFC4QDISCQAAAAAAAPA/EQAAAAAAULhAEq0BCiRhbWF6b25hd3MuY29tL0FXUy9FQzIvQ1BVVXRpbGl6YXRpb24aASVagQEKfwoUCglOYW1lc3BhY2USB0FXUy9FQzIKHAoKTWV0cmljTmFtZRIOQ1BVVXRpbGl6YXRpb24KIQoKSW5zdGFuY2VJZBITaS0wNGE4NTIxMzMyYzc4ZmY0ZREA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAADIAMgkJAAAAAAAA8D8SsAEKJWFtYXpvbmF3cy5jb20vQVdTL0VDMi9NZXRhZGF0YU5vVG9rZW4aATFagwEKgAEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyCh0KCk1ldHJpY05hbWUSD01ldGFkYXRhTm9Ub2tlbgohCgpJbnN0YW5jZUlkEhNpLTA0YTg1MjEzMzJjNzhmZjRlEQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAMgAyCQkAAAAAAADwPxLJAQohYW1hem9uYXdzLmNvbS9BV1MvRUMyL0VCU1dyaXRlT3BzGgd7Q291bnR9WpoBCpcBChQKCU5hbWVzcGFjZRIHQVdTL0VDMgoZCgpNZXRyaWNOYW1lEgtFQlNXcml0ZU9wcwohCgpJbnN0YW5jZUlkEhNpLTA3OTY5NWUyZGI4Zjc0ZDEwEQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAKQAAAAAAWI1AMgkRAAAAAADgfEAyEgkAAAAAAADwPxEAAAAAANB9QBLAAQofYW1hem9uYXdzLmNvbS9BV1MvRUMyL05ldHdvcmtJbhoCQnlamAEKlQEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyChcKCk1ldHJpY05hbWUSCU5ldHdvcmtJbgohCgpJbnN0YW5jZUlkEhNpLTAxNmFkOTA2MjZiMjc2OTc2EQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAKQAAAACAs8NAMgkRAAAAAAA4qkAyEgkAAAAAAADwPxEAAAAAAEu6QBLIAQojYW1hem9uYXdzLmNvbS9BV1MvRUMyL0VCU1dyaXRlQnl0ZXMaAkJ5WpwBCpkBChQKCU5hbWVzcGFjZRIHQVdTL0VDMgobCgpNZXRyaWNOYW1lEg1FQlNXcml0ZUJ5dGVzCiEKCkluc3RhbmNlSWQSE2ktMDhmM2U0YzllNzczOWQ5MWURAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAACSYskEyCREAAAAAIJ1xQTISCQAAAAAAAPA/EQAAAABSfrFBEskBCiFhbWF6b25hd3MuY29tL0FXUy9FQzIvRUJTV3JpdGVPcHMaB3tDb3VudH1amgEKlwEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyChkKCk1ldHJpY05hbWUSC0VCU1dyaXRlT3BzCiEKCkluc3RhbmNlSWQSE2ktMDRhODUyMTMzMmM3OGZmNGURAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAAAAAR0AyCREAAAAAAAA2QDISCQAAAAAAAPA/EQAAAAAAADhAEqoBCiBhbWF6b25hd3MuY29tL0FXUy9FQzIvRUJTUmVhZE9wcxoHe0NvdW50fVp9CnsKFAoJTmFtZXNwYWNlEgdBV1MvRUMyChgKCk1ldHJpY05hbWUSCkVCU1JlYWRPcHMKIQoKSW5zdGFuY2VJZBITaS0wMTZhZDkwNjI2YjI3Njk3NhEA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAADIAMgkJAAAAAAAA8D8SqQEKImFtYXpvbmF3cy5jb20vQVdTL0VDMi9FQlNSZWFkQnl0ZXMaAkJ5Wn8KfQoUCglOYW1lc3BhY2USB0FXUy9FQzIKGgoKTWV0cmljTmFtZRIMRUJTUmVhZEJ5dGVzCiEKCkluc3RhbmNlSWQSE2ktMDY2MDllODk3ZDdkNGNiMWURAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAAyADIJCQAAAAAAAPA/EsIBCiBhbWF6b25hd3MuY29tL0FXUy9FQzIvTmV0d29ya091dBoCQnlamQEKlgEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyChgKCk1ldHJpY05hbWUSCk5ldHdvcmtPdXQKIQoKSW5zdGFuY2VJZBITaS0wNzk2OTVlMmRiOGY3NGQxMBEA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAAIBmQDIJEQAAAAAAgFZAMhIJAAAAAAAA8D8RAAAAAACAVkAS1QEKJ2FtYXpvbmF3cy5jb20vQVdTL0VDMi9OZXR3b3JrUGFja2V0c091dBoHe0NvdW50fVqgAQqdAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKHwoKTWV0cmljTmFtZRIRTmV0d29ya1BhY2tldHNPdXQKIQoKSW5zdGFuY2VJZBITaS0wOGYzZTRjOWU3NzM5ZDkxZREA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAAIBmQDIJEQAAAAAAQFRAMhIJAAAAAAAA8D8RAAAAAADAWEAS1QEKJ2FtYXpvbmF3cy5jb20vQVdTL0VDMi9OZXR3b3JrUGFja2V0c091dBoHe0NvdW50fVqgAQqdAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKHwoKTWV0cmljTmFtZRIRTmV0d29ya1BhY2tldHNPdXQKIQoKSW5zdGFuY2VJZBITaS0wNzk2OTVlMmRiOGY3NGQxMBEA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAAAAAQDIJEQAAAAAAAPA/MhIJAAAAAAAA8D8RAAAAAAAA8D8SyAEKI2FtYXpvbmF3cy5jb20vQVdTL0VDMi9FQlNXcml0ZUJ5dGVzGgJCeVqcAQqZAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKGwoKTWV0cmljTmFtZRINRUJTV3JpdGVCeXRlcwohCgpJbnN0YW5jZUlkEhNpLTAxNmFkOTA2MjZiMjc2OTc2EQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAKQAAAACA8GxBMgkRAAAAAAAcW0EyEgkAAAAAAADwPxEAAAAAAMVeQRLAAQofYW1hem9uYXdzLmNvbS9BV1MvRUMyL05ldHdvcmtJbhoCQnlamAEKlQEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyChcKCk1ldHJpY05hbWUSCU5ldHdvcmtJbgohCgpJbnN0YW5jZUlkEhNpLTA2NjA5ZTg5N2Q3ZDRjYjFlEQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAKQAAAABg6elAMgkRAAAAAIDZ10AyEgkAAAAAAADwPxEAAAAAQPnbQBLLAQolYW1hem9uYXdzLmNvbS9BV1MvRUMyL0VCU0J5dGVCYWxhbmNlJRoBJVqeAQqbAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKHQoKTWV0cmljTmFtZRIPRUJTQnl0ZUJhbGFuY2UlCiEKCkluc3RhbmNlSWQSE2ktMDA4NTMwZGQzMTA3ZjQ0NGIRAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAAADgaEAyCREAAAAAAMBYQDISCQAAAAAAAPA/EQAAAAAAAFlAEsgBCiNhbWF6b25hd3MuY29tL0FXUy9FQzIvRUJTV3JpdGVCeXRlcxoCQnlanAEKmQEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyChsKCk1ldHJpY05hbWUSDUVCU1dyaXRlQnl0ZXMKIQoKSW5zdGFuY2VJZBITaS0wMDg1MzBkZDMxMDdmNDQ0YhEA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAwO9uQTIJEQAAAACApV1BMhIJAAAAAAAA8D8RAAAAAAAdYEESwgEKIGFtYXpvbmF3cy5jb20vQVdTL0VDMi9OZXR3b3JrT3V0GgJCeVqZAQqWAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKGAoKTWV0cmljTmFtZRIKTmV0d29ya091dAohCgpJbnN0YW5jZUlkEhNpLTA4ZjNlNGM5ZTc3MzlkOTFlEQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAKQAAAACgMOVAMgkRAAAAAAAmz0AyEgkAAAAAAADwPxEAAAAAQM7aQBLCAQogYW1hem9uYXdzLmNvbS9BV1MvRUMyL05ldHdvcmtPdXQaAkJ5WpkBCpYBChQKCU5hbWVzcGFjZRIHQVdTL0VDMgoYCgpNZXRyaWNOYW1lEgpOZXR3b3JrT3V0CiEKCkluc3RhbmNlSWQSE2ktMDA4NTMwZGQzMTA3ZjQ0NGIRAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAAABgf0AyCREAAAAAAIBWQDISCQAAAAAAAPA/EQAAAAAAwHlAEtMBCiZhbWF6b25hd3MuY29tL0FXUy9FQzIvTmV0d29ya1BhY2tldHNJbhoHe0NvdW50fVqfAQqcAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKHgoKTWV0cmljTmFtZRIQTmV0d29ya1BhY2tldHNJbgohCgpJbnN0YW5jZUlkEhNpLTAwODUzMGRkMzEwN2Y0NDRiEQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAKQAAAAAAABxAMgkRAAAAAAAA8D8yEgkAAAAAAADwPxEAAAAAAAAYQBKqAQogYW1hem9uYXdzLmNvbS9BV1MvRUMyL0VCU1JlYWRPcHMaB3tDb3VudH1afQp7ChQKCU5hbWVzcGFjZRIHQVdTL0VDMgoYCgpNZXRyaWNOYW1lEgpFQlNSZWFkT3BzCiEKCkluc3RhbmNlSWQSE2ktMDA4NTMwZGQzMTA3ZjQ0NGIRAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAAyADIJCQAAAAAAAPA/EssBCiVhbWF6b25hd3MuY29tL0FXUy9FQzIvRUJTQnl0ZUJhbGFuY2UlGgElWp4BCpsBChQKCU5hbWVzcGFjZRIHQVdTL0VDMgodCgpNZXRyaWNOYW1lEg9FQlNCeXRlQmFsYW5jZSUKIQoKSW5zdGFuY2VJZBITaS0wNGE4NTIxMzMyYzc4ZmY0ZREA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAAMBoQDIJEQAAAAAAwFhAMhIJAAAAAAAA8D8RAAAAAADAWEASyQEKIWFtYXpvbmF3cy5jb20vQVdTL0VDMi9FQlNXcml0ZU9wcxoHe0NvdW50fVqaAQqXAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKGQoKTWV0cmljTmFtZRILRUJTV3JpdGVPcHMKIQoKSW5zdGFuY2VJZBITaS0wMTZhZDkwNjI2YjI3Njk3NhEA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAAOCDQDIJEQAAAAAAEHFAMhIJAAAAAAAA8D8RAAAAAACwdkASzwEKJGFtYXpvbmF3cy5jb20vQVdTL0VDMi9DUFVDcmVkaXRVc2FnZRoHe0NvdW50fVqdAQqaAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKHAoKTWV0cmljTmFtZRIOQ1BVQ3JlZGl0VXNhZ2UKIQoKSW5zdGFuY2VJZBITaS0wZTQzNmY2ODQ4ZDM3ZGQ0MhEA4OnVOVFzFhkAODHOR1FzFiEBAAAAAAAAACmtMlNaf0u8PzIJEa0yU1p/S7w/MhIJAAAAAAAA8D8RrTJTWn9LvD8SqQEKImFtYXpvbmF3cy5jb20vQVdTL0VDMi9FQlNSZWFkQnl0ZXMaAkJ5Wn8KfQoUCglOYW1lc3BhY2USB0FXUy9FQzIKGgoKTWV0cmljTmFtZRIMRUJTUmVhZEJ5dGVzCiEKCkluc3RhbmNlSWQSE2ktMDc5Njk1ZTJkYjhmNzRkMTARAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAAyADIJCQAAAAAAAPA/EsgBCiNhbWF6b25hd3MuY29tL0FXUy9FQzIvRUJTV3JpdGVCeXRlcxoCQnlanAEKmQEKFAoJTmFtZXNwYWNlEgdBV1MvRUMyChsKCk1ldHJpY05hbWUSDUVCU1dyaXRlQnl0ZXMKIQoKSW5zdGFuY2VJZBITaS0wNGE4NTIxMzMyYzc4ZmY0ZREA4OnVOVFzFhkAODHOR1FzFiECAAAAAAAAACkAAAAAAAAHQTIJEQAAAAAAAPZAMhIJAAAAAAAA8D8RAAAAAAAA+EASqgEKIGFtYXpvbmF3cy5jb20vQVdTL0VDMi9FQlNSZWFkT3BzGgd7Q291bnR9Wn0KewoUCglOYW1lc3BhY2USB0FXUy9FQzIKGAoKTWV0cmljTmFtZRIKRUJTUmVhZE9wcwohCgpJbnN0YW5jZUlkEhNpLTA2NjA5ZTg5N2Q3ZDRjYjFlEQDg6dU5UXMWGQA4Mc5HUXMWIQIAAAAAAAAAMgAyCQkAAAAAAADwPxLLAQolYW1hem9uYXdzLmNvbS9BV1MvRUMyL0VCU0J5dGVCYWxhbmNlJRoBJVqeAQqbAQoUCglOYW1lc3BhY2USB0FXUy9FQzIKHQoKTWV0cmljTmFtZRIPRUJTQnl0ZUJhbGFuY2UlCiEKCkluc3RhbmNlSWQSE2ktMDc5Njk1ZTJkYjhmNzRkMTARAODp1TlRcxYZADgxzkdRcxYhAgAAAAAAAAApAAAAAADAaEAyCREAAAAAAMBYQDISCQAAAAAAAPA/EQAAAAAAwFhA'},
			]
		}

		ret = lambda_function.lambda_handler(self.event, "")
		assert ret['records'][0]['result'] == "Ok"


if __name__ == '__main__':
	unittest.main()